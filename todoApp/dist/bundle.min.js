(()=>{"use strict";function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var t=null,n={},a=function(){function a(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a)}var r,i;return r=a,i=[{key:"verifyUniqueUser",value:function(e){return!(n=JSON.parse(localStorage.getItem("data"))||{})[e]}},{key:"hashCode",value:function(e,t){var n,a=e+t,r=0;for(n=0;n<a.length;n++)r=(r<<5)-r+a.charCodeAt(n),r|=0;return Math.abs(r)}},{key:"registerNewUser",value:function(e,r){if(a.verifyUniqueUser(e)){t=e,n=JSON.parse(localStorage.getItem("data"))||{};var i=Date.now();return n[e]={password:{salt:i,hash:a.hashCode(i,r)}},a.saveAllLists([]),!0}return!1}},{key:"logInUser",value:function(e,r){if(!(n=JSON.parse(localStorage.getItem("data")))||!n[e])return n=null,!1;var i=n[e].password;return a.hashCode(i.salt,r)===i.hash&&(t=e,!0)}},{key:"logOutUser",value:function(){t=null}},{key:"readAllLists",value:function(){if(t)return(n=JSON.parse(localStorage.getItem("data")))[t].lists;console.error("User is not logged in.")}},{key:"saveAllLists",value:function(e){t?(n[t].lists=e,localStorage.setItem("data",JSON.stringify(n))):console.error("User is not logged in.")}}],null&&e(r.prototype,null),i&&e(r,i),a}();function r(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.modalHeader,n=void 0===t?"":t,a=e.modalContent,r=void 0===a?"":a,l=e.callbackOnClose,s=void 0===l?null:l,o='<div id="modalBackground">\n                  <div class="modalFrame">\n                    <div class="modalHeader">\n                      <span>'.concat(n,'</span>\n                      <span id="closeModal">&times;</span>\n                    </div>\n                    <div id="modalContent">\n                      ').concat(r,"\n                    </div>\n                  </div>\n                </div>");document.body.insertAdjacentHTML("beforeend",o);var d=function e(t){(t.target&&(t.target===document.getElementById("modalBackground")||t.target===document.getElementById("closeModal"))||t.key&&"Escape"===t.key)&&(i(),s&&s(),document.body.removeEventListener("keyup",e))};document.getElementById("closeModal").addEventListener("click",d),document.getElementById("modalBackground").addEventListener("click",d),document.body.addEventListener("keyup",d)}function i(){var e=document.getElementById("modalBackground");e&&e.remove()}function l(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=s(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,l=!0,o=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return l=e.done,e},e:function(e){o=!0,i=e},f:function(){try{l||null==n.return||n.return()}finally{if(o)throw i}}}}function s(e,t){if(e){if("string"==typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(e,t):void 0}}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function d(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var m=null,u=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.listName,a=void 0===n?null:n,r=t.items,i=void 0===r?[]:r,l=t.filter,s=void 0===l?"all":l;d(this,e),this.listName=a||null,this.items=i.length?i:[],this.filter=s||"all"}var t,n,o;return t=e,o=[{key:"initGallery",value:function(){m=[],e.readAllLists(),e.renderAllLists()}},{key:"createList",value:function(){m.push(new e),r({modalContent:'<label for="newName">List name\n                            <input type="text" name="newName" id="newName">\n                          </label>\n                          <button id="nameList" class="btn">Create list</button>',modalHeader:"Create a list",callbackOnClose:function(){m[m.length-1].name||m.pop()}}),document.getElementById("newName").focus();var t=function(){var t=document.getElementById("newName").value;if(t){var n=m[m.length-1];n.listName=t,n.renderEditableList(),e.saveAllLists(),document.getElementById("addItemInput").focus()}};document.getElementById("nameList").addEventListener("click",t),document.getElementById("newName").addEventListener("keyup",(function(e){"Enter"===e.key&&t()}))}},{key:"renderAllLists",value:function(){var e=document.getElementById("main");if(m.length){e.innerHTML="";var t,n=l(m);try{for(n.s();!(t=n.n()).done;)t.value.renderStaticList()}catch(e){n.e(e)}finally{n.f()}}else e.innerHTML='<p class="welcomeMsg">Click "Create a list" to get started!</p>'}},{key:"readAllLists",value:function(){var t=a.readAllLists(m);if(t){var n,r=l(t);try{for(r.s();!(n=r.n()).done;){var i=n.value;m.push(new e({listName:i.listName,items:i.items,filter:i.filter}))}}catch(e){r.e(e)}finally{r.f()}}}},{key:"saveAllLists",value:function(){a.saveAllLists(m)}},{key:"showAllListsInConsole",value:function(){console.log(m)}}],(n=[{key:"renderStaticList",value:function(){var e=this,t=document.createElement("div");t.className="staticListDiv",t.addEventListener("click",(function(){e.renderEditableList()}));var n=document.createElement("header");n.innerText=this.listName,t.appendChild(n);var a,r=l(this.items);try{for(r.s();!(a=r.n()).done;){var i=a.value,s=document.createElement("p");s.innerText=i.content,s.className=i.completed?"completed":"",t.appendChild(s)}}catch(e){r.e(e)}finally{r.f()}document.getElementById("main").appendChild(t)}},{key:"sumActiveItems",value:function(){var e,t=0,n=l(this.items);try{for(n.s();!(e=n.n()).done;){var a=e.value;t+=Number(!a.completed)}}catch(e){n.e(e)}finally{n.f()}document.getElementById("totalActiveSpan").innerText=t||"No"}},{key:"renderEditableList",value:function(){var t=this;i(),r({modalHeader:'<div class="editableListHeader">\n                          <span>'.concat(this.listName,'</span>\n                          <span id="deleteList"><i class="far fa-trash-alt"></i></span>\n                          <span id="renameList"><i class="fas fa-pencil-alt"></i></span>\n                        </div>'),callbackOnClose:e.renderAllLists}),document.getElementById("deleteList").addEventListener("click",(function(){t.deleteList()})),document.getElementById("renameList").addEventListener("click",(function(){t.renameList()}));var n=document.getElementById("modalContent"),a=document.createElement("div");a.className="itemsContainer";var o,d=function(n){n.preventDefault();var a=n.target.closest(".listItemDiv");a.classList.add("moving");var r=n.clientY,i=function(e){var n=e.clientY-r;a.style.transform="translateY(".concat(n,"px)");var i=parseInt(a.dataset.index),l=a.getBoundingClientRect().top,s=a.parentElement;if(i>0&&l<s.children[i-1].getBoundingClientRect().top){r=e.clientY,a.style.transform="translateY(0px)";var o=s.replaceChild(a,s.children[i-1]);a.insertAdjacentElement("afterEnd",o),o.dataset.index=i,a.dataset.index=i-1;var d=t.items[i];t.items[i]=t.items[i-1],t.items[i-1]=d}else if(i<s.children.length-2&&l>s.children[i+1].getBoundingClientRect().top){r=e.clientY,a.style.transform="translateY(0px)";var c=s.replaceChild(a,s.children[i+1]);a.insertAdjacentElement("beforeBegin",c),c.dataset.index=i,a.dataset.index=i+1;var m=t.items[i];t.items[i]=t.items[i+1],t.items[i+1]=m}};document.body.addEventListener("mousemove",i),document.body.addEventListener("mouseup",(function n(r){a.classList.remove("moving"),document.body.removeEventListener("mousemove",i),document.body.removeEventListener("mouseup",n),t.renderEditableList(),e.saveAllLists()}))},c=l(this.items.entries());try{var m=function(){var n=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],a=!0,r=!1,i=void 0;try{for(var l,s=e[Symbol.iterator]();!(a=(l=s.next()).done)&&(n.push(l.value),!t||n.length!==t);a=!0);}catch(e){r=!0,i=e}finally{try{a||null==s.return||s.return()}finally{if(r)throw i}}return n}}(e,t)||s(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(o.value,2),r=n[0],i=n[1],l=document.createElement("div");l.setAttribute("data-index",r),l.className="listItemDiv          ".concat(i.completed?"completed":"active","          ").concat("active"===t.filter&&i.completed?"hidden":"","          ").concat("completed"!==t.filter||i.completed?"":"hidden");var c=document.createElement("i");c.className="fas fa-grip-horizontal",c.addEventListener("mousedown",d),l.appendChild(c);var m=document.createElement("input");m.type="checkbox",m.className="completeCheckbox",m.checked=i.completed,m.addEventListener("click",(function(e){t.completeItem(e,i)})),l.appendChild(m);var u=document.createElement("span");u.innerText=i.content,u.className=i.completed?"completed":"",u.addEventListener("click",(function(t){!function(t,n){var a=t.target,r=!1,i=function(t){r||(r=!0,a.innerText=t.target.value,n.content=t.target.value,document.getElementById("newContentInput").remove(),a.style.display="initial",e.saveAllLists())};a.style.display="none";var l=document.createElement("input");l.id="newContentInput",l.value=a.innerText,l.addEventListener("blur",i),l.addEventListener("keyup",(function(e){"Enter"===e.key&&i(e)})),a.insertAdjacentElement("afterend",l),l.focus()}(t,i)})),l.appendChild(u);var v=document.createElement("button");v.innerHTML='<i class="far fa-trash-alt"></i>',v.className="btn warning",v.addEventListener("click",(function(e){t.deleteItem(e,i)})),l.appendChild(v),a.appendChild(l)};for(c.s();!(o=c.n()).done;)m()}catch(e){c.e(e)}finally{c.f()}var u=document.createElement("footer");u.className="itemsContainerFooter";var v=document.createElement("p");v.className="totalActiveP";var f=document.createElement("span");f.id="totalActiveSpan",v.appendChild(f);var y=document.createTextNode(" tasks left");v.appendChild(y),u.appendChild(v);var p=function(n){t.filter=n||"all";var a,r=document.getElementsByClassName("listItemDiv active"),i=document.getElementsByClassName("listItemDiv completed"),s=l(document.getElementsByClassName("filter"));try{for(s.s();!(a=s.n()).done;)a.value.classList.remove("current")}catch(e){s.e(e)}finally{s.f()}switch(n){case"active":var o,d=l(r);try{for(d.s();!(o=d.n()).done;)o.value.classList.remove("hidden")}catch(e){d.e(e)}finally{d.f()}var c,m=l(i);try{for(m.s();!(c=m.n()).done;)c.value.classList.add("hidden")}catch(e){m.e(e)}finally{m.f()}document.getElementsByClassName("filter active")[0].classList.add("current");break;case"completed":var u,v=l(i);try{for(v.s();!(u=v.n()).done;)u.value.classList.remove("hidden")}catch(e){v.e(e)}finally{v.f()}var f,y=l(r);try{for(y.s();!(f=y.n()).done;)f.value.classList.add("hidden")}catch(e){y.e(e)}finally{y.f()}document.getElementsByClassName("filter completed")[0].classList.add("current");break;default:var p,g=l(i);try{for(g.s();!(p=g.n()).done;)p.value.classList.remove("hidden")}catch(e){g.e(e)}finally{g.f()}var h,E=l(r);try{for(E.s();!(h=E.n()).done;)h.value.classList.remove("hidden")}catch(e){E.e(e)}finally{E.f()}document.getElementsByClassName("filter all")[0].classList.add("current")}e.saveAllLists()},g=document.createElement("span");g.className="filterContainer";var h=document.createElement("i");h.className="fas fa-filter",g.appendChild(h);var E=document.createElement("button");E.className="btn filter all ".concat("all"===this.filter?"current":""),E.innerText="All",E.addEventListener("click",(function(){p("all")})),g.appendChild(E);var b=document.createElement("button");b.className="btn filter active ".concat("active"===this.filter?"current":""),b.innerText="Active",b.addEventListener("click",(function(){p("active")})),g.appendChild(b);var L=document.createElement("button");L.className="btn filter completed ".concat("completed"===this.filter?"current":""),L.innerText="Completed",L.addEventListener("click",(function(){p("completed")})),g.appendChild(L),u.appendChild(g),a.appendChild(u),n.appendChild(a);var I=document.createElement("footer"),k=document.createElement("input");k.id="addItemInput",k.addEventListener("keyup",(function(e){"Enter"===e.key&&t.addItem()})),I.appendChild(k);var w=document.createElement("button");w.className="btn",w.innerHTML='<i class="fas fa-plus"></i>',w.addEventListener("click",(function(){t.addItem()})),I.appendChild(w),n.appendChild(I),this.sumActiveItems(),this.items.length||document.getElementById("addItemInput").focus()}},{key:"addItem",value:function(){var t=document.getElementById("addItemInput");t.value&&(this.items.push({id:Date.now(),content:t.value,completed:!1}),t.value="",this.renderEditableList(),document.getElementById("addItemInput").focus(),e.saveAllLists())}},{key:"completeItem",value:function(t,n){n.completed=!n.completed,this.renderEditableList(),e.saveAllLists()}},{key:"deleteItem",value:function(t,n){var a=this.items.findIndex((function(e){return e.id===n.id}));this.items.splice(a,1),e.saveAllLists(),t.target.closest(".btn").parentElement.remove(),this.sumActiveItems()}},{key:"renameList",value:function(){var t=this;i(),r({modalContent:'<label for="newName">New list name\n                            <input type="text" name="newName" id="newName"\n                                value="'.concat(this.listName,'">\n                          </label>\n                          <button id="renameList" class="btn">Save</button>'),modalHeader:"Change list name"}),document.getElementById("newName").focus();var n=function(){var n=document.getElementById("newName").value;n&&(t.listName=n,i(),e.renderAllLists(),t.renderEditableList(),e.saveAllLists())};document.getElementById("renameList").addEventListener("click",n),document.getElementById("newName").addEventListener("keyup",(function(e){"Enter"===e.key&&n()}))}},{key:"deleteList",value:function(){var t=this;i(),r({modalHeader:"Confirm delete",modalContent:"<div>\n                            <p>Are you sure you want to permanently delete ".concat(this.listName,'?\n                            <div>\n                              <button id="cancelDelete" class="btn">Cancel</button>\n                              <button id="confirmDelete" class="btn warning">Delete</button>\n                            </div>\n                          </div>'),callbackOnClose:function(){t.renderEditableList()}}),document.getElementById("cancelDelete").addEventListener("click",(function(){t.renderEditableList()})),document.getElementById("confirmDelete").addEventListener("click",(function(){var n=m.indexOf(t);m.splice(n,1),e.saveAllLists(),i(),e.renderAllLists()}))}}])&&c(t.prototype,n),o&&c(t,o),e}();function v(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var f=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),document.getElementById("main").innerHTML=p,document.getElementById("loginBtn").addEventListener("click",this.logInUser),document.getElementById("registerBtn").addEventListener("click",this.registerNewUserName),document.getElementById("logout").addEventListener("click",this.logOutUser),document.body.addEventListener("keyup",(function(e){"Enter"!==e.key||e.target!==document.getElementById("loginUsername")&&e.target!==document.getElementById("loginPassword")?"Enter"===e.key&&e.target===document.getElementById("registerPassword2")&&document.getElementById("registerBtn").click():document.getElementById("loginBtn").click()}))}var t,n;return t=e,(n=[{key:"registerNewUserName",value:function(){var e=document.getElementById("registerUsername").value,t=document.getElementById("registerPassword1").value,n=document.getElementById("registerPassword2").value,r=document.getElementById("registerError");e.length<5?r.innerText="User name must be at least 5 characters.":a.verifyUniqueUser(e)?t.length<10?r.innerHTML="Password must be at least 10 characters.":t!==n?r.innerHTML="Passwords must match.":(a.registerNewUserName(e,t),y()):r.innerHTML="User name already exists in our system.<br>          Do you want to log in?",r.className="error"}},{key:"logInUser",value:function(){var e=document.getElementById("loginUsername").value,t=document.getElementById("loginPassword").value;if(a.logInUser(e,t))y();else{var n=document.getElementById("loginError");n.innerHTML="Invalid user name and password comb.<br>          Do you want to register as a New User?",n.className="error"}}},{key:"logOutUser",value:function(){document.location.href=document.location.href}}])&&v(t.prototype,n),e}();function y(){u.initGallery(),document.getElementById("createList").style.visibility="visible",document.getElementById("logout").style.visibility="visible",document.getElementById("createList").addEventListener("click",(function(){u.createList()})),document.querySelector("body header h1").addEventListener("click",(function(){u.showAllListsInConsole()}))}var p='<div class="loginDiv">\n      <header>Log In</header>\n      <label for="loginUsername">User Name\n        <input type="text" name="loginUsername" id="loginUsername">\n      </label>\n      <label for="loginPassword">Password\n        <input type="password" name="loginPassword" id="loginPassword">\n      </label>\n      <div class="right"><button id="loginBtn" class="btn">Go</button></div>\n      <div id="loginError"></div>\n    </div>\n\n    \x3c!-- Register --\x3e\n    <div class="loginDiv">\n      <header>Register New User</header>\n      <label for="registerUsername">User Name\n        <input type="text" name="registerUsername" id="registerUsername">\n      </label>\n      <label for="registerPassword1">Password\n        <input type="password" name="registerPassword1" id="registerPassword1">\n      </label>\n      <label for="registerPassword2">Repeat Password\n        <input type="password" name="registerPassword2" id="registerPassword2">\n      </label>\n      <div class="right"><button id="registerBtn" class="btn">Go</button></div>\n      <div id="registerError"></div>\n    </div>';new f})();